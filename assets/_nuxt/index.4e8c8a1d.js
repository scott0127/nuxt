const l=/\d/,d=["-","_","/","."];function y(r=""){if(!l.test(r))return r!==r.toLowerCase()}function p(r,t){const o=t??d,e=[];if(!r||typeof r!="string")return e;let n="",i,f;for(const s of r){const c=o.includes(s);if(c===!0){e.push(n),n="",i=void 0;continue}const u=y(s);if(f===!1){if(i===!1&&u===!0){e.push(n),n=s,i=u;continue}if(i===!0&&u===!1&&n.length>1){const a=n.at(-1);e.push(n.slice(0,Math.max(0,n.length-1))),n=a+s,i=u;continue}}n+=s,i=u,f=c}return e.push(n),e}function N(r){return r?r[0].toUpperCase()+r.slice(1):""}function S(r,t){return r?(Array.isArray(r)?r:p(r)).map(o=>N(t!=null&&t.normalize?o.toLowerCase():o)).join(""):""}function E(r,t){return r?(Array.isArray(r)?r:p(r)).map(o=>o.toLowerCase()).join(t??"-"):""}const _=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,h=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,w=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function C(r,t){if(r==="__proto__"||r==="constructor"&&t&&typeof t=="object"&&"prototype"in t){I(r);return}return t}function I(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function m(r,t={}){if(typeof r!="string")return r;const o=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return o.slice(1,-1);if(o.length<=9){const e=o.toLowerCase();if(e==="true")return!0;if(e==="false")return!1;if(e==="undefined")return;if(e==="null")return null;if(e==="nan")return Number.NaN;if(e==="infinity")return Number.POSITIVE_INFINITY;if(e==="-infinity")return Number.NEGATIVE_INFINITY}if(!w.test(r)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(_.test(r)||h.test(r)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,C)}return JSON.parse(r)}catch(e){if(t.strict)throw e;return r}}export{m as d,E as k,S as p};
